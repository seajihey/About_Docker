# ğŸ³ Docker ì´ë¯¸ì§€ ê²½ëŸ‰í™”: ëŠë¦° ë°°í¬ì˜ ì›ì¸ê³¼ í•´ê²°ì±…

> Spring Boot ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ Docker ì´ë¯¸ì§€ë¥¼ **753MB â†’ 122MB**ë¡œ **84% ê²½ëŸ‰í™”**í•œ ì‹¤ì „ ê°€ì´ë“œ

---

## ğŸ“‹ ëª©ì°¨

- [ğŸ¯ ì„œë¡ : ì™œ ë‹¤ì‹œ 'ë°°í¬'ë¥¼ ì´ì•¼ê¸°í•˜ëŠ”ê°€?](#-ì„œë¡ -ì™œ-ë‹¤ì‹œ-ë°°í¬ë¥¼-ì´ì•¼ê¸°í•˜ëŠ”ê°€)
- [ğŸ” Dockerì˜ ë³¸ì§ˆ ì´í•´í•˜ê¸°](#-dockerì˜-ë³¸ì§ˆ-ì´í•´í•˜ê¸°)
- [â“ ë„ì»¤ ì´ë¯¸ì§€ëŠ” ì™œ ë¬´ê±°ì›Œì§€ëŠ”ê°€?](#-ë„ì»¤-ì´ë¯¸ì§€ëŠ”-ì™œ-ë¬´ê±°ì›Œì§€ëŠ”ê°€)
- [ğŸš€ ì´ë¯¸ì§€ ìµœì í™” ì „ëµ](#-ì´ë¯¸ì§€-ìµœì í™”-ì „ëµ)
- [ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#-íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)
- [ğŸ“Š CI/CD íŒŒì´í”„ë¼ì¸ ê°œì„  íš¨ê³¼](#-cicd-íŒŒì´í”„ë¼ì¸-ê°œì„ -íš¨ê³¼)
- [âœ… ìµœì í™” ì²´í¬ë¦¬ìŠ¤íŠ¸](#-ìµœì í™”-ì²´í¬ë¦¬ìŠ¤íŠ¸)
- [ğŸ“š ì°¸ê³  ìë£Œ](#-ì°¸ê³ -ìë£Œ)

---

## ğŸ¯ ì„œë¡ : ì™œ ë‹¤ì‹œ 'ë°°í¬'ë¥¼ ì´ì•¼ê¸°í•˜ëŠ”ê°€?

### ğŸ“ˆ ì»´í“¨íŒ… ìì› ê´€ë¦¬ì˜ ì§„í™”

| ì‹œëŒ€ | ê¸°ìˆ  | íŠ¹ì§• | í•œê³„ |
|:----:|:----:|:----:|:----:|
| 1ï¸âƒ£ | Bare Metal | ë¬¼ë¦¬ ì„œë²„ ì§ì ‘ ìš´ì˜ | ìì› ë‚­ë¹„, í™•ì¥ ì–´ë ¤ì›€ |
| 2ï¸âƒ£ | FreeBSD Jail | OS ìˆ˜ì¤€ ê°€ìƒí™”(ì»¨í…Œì´ë„ˆí™”) | ìƒíƒœê³„ ë° í‘œì¤€í™” ë¶€ì¡± |
| 3ï¸âƒ£ | LXC | ì»¤ë„ ê³µìœ  ê¸°ë°˜ ì»¨í…Œì´ë„ˆ | ì„¤ì • ë³µì¡ì„± |
| 4ï¸âƒ£ | **Docker** | í‘œì¤€í™”ëœ ì»¨í…Œì´ë„ˆ | **ì˜¤ëŠ˜ì˜ ì£¼ì œ** |

### ğŸ¤” ë¬¸ì œ ì œê¸°

> *"ìš°ë¦¬ íŒ€ì€ Dockerë¥¼ ì“°ëŠ”ë° ì™œ ë°°í¬ê°€ ì—¬ì „íˆ ëŠë¦´ê¹Œ?"*

ë§ì€ íŒ€ì´ Dockerë¥¼ ë„ì…í–ˆì§€ë§Œ, ì—¬ì „íˆ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œì— ì§ë©´í•©ë‹ˆë‹¤:

- â° ì´ë¯¸ì§€ ë¹Œë“œì— **10ë¶„ ì´ìƒ** ì†Œìš”
- ğŸŒ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ Pull ë°›ëŠ” ë° **ë„¤íŠ¸ì›Œí¬ ë³‘ëª©** ë°œìƒ
- ğŸ’¸ í´ë¼ìš°ë“œ **Egress ë¹„ìš©**ì˜ ë¶€ë‹´ë˜ëŠ” ê°€ê²©
- ğŸ¢ ì˜¤í† ìŠ¤ì¼€ì¼ë§ ì‹œ ìƒˆ ì¸ìŠ¤í„´ìŠ¤ ê¸°ë™ì´ ëŠë¦¼

**ğŸ“Œ í”„ë¡œì íŠ¸ì˜ ëª©í‘œ**: `í˜„ìƒ â†’ ì›ì¸ â†’ í•´ê²°ì±… â†’ ë¹„ì¦ˆë‹ˆìŠ¤ ê°€ì¹˜`ì˜ íë¦„ìœ¼ë¡œ Docker ì´ë¯¸ì§€ ìµœì í™”ë¥¼ ì™„ì „íˆ ì´í•´í•©ë‹ˆë‹¤.

---

## ğŸ” Dockerì˜ ë³¸ì§ˆ 

### ğŸ“¦ Infrastructure as Code (IaC)

DockerëŠ” ë‹¨ìˆœí•œ ê°€ìƒí™” ë„êµ¬ê°€ ì•„ë‹™ë‹ˆë‹¤. **ì¸í”„ë¼ë¥¼ ì½”ë“œë¡œ ì •ì˜**í•˜ëŠ” IaCì˜ í•µì‹¬ ë„êµ¬ì…ë‹ˆë‹¤.

```dockerfile
# ì´ê²ƒì€ ì„¤ì • íŒŒì¼ì´ ì•„ë‹Œ, ì¸í”„ë¼ë¥¼ ì •ì˜í•˜ëŠ” 'ì½”ë“œ'ì…ë‹ˆë‹¤
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
CMD ["node", "server.js"]
```

### ğŸ”’ ê²©ë¦¬ ë©”ì»¤ë‹ˆì¦˜

Docker ì»¨í…Œì´ë„ˆì˜ ê²©ë¦¬ëŠ” Linux ì»¤ë„ì˜ ë‘ ê°€ì§€ í•µì‹¬ ê¸°ëŠ¥ì— ì˜ì¡´í•©ë‹ˆë‹¤:

| ê¸°ìˆ  | ì—­í•  | ê²©ë¦¬ ëŒ€ìƒ |
|:----:|:----:|:----------|
| ğŸ”’ **Namespace** | í”„ë¡œì„¸ìŠ¤ ê²©ë¦¬ | PID, Network, Mount, User ë“± |
| ğŸ“Š **cgroups** | ìì› ì œí•œ | CPU, Memory, I/O |

ì´ ë‘ ê¸°ìˆ  ë•ë¶„ì— ì»¨í…Œì´ë„ˆëŠ” VM ì—†ì´ë„ ì™„ì „í•œ ê²©ë¦¬ í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤.

---

## â“ ë„ì»¤ ì´ë¯¸ì§€ëŠ” ì™œ ë¬´ê±°ì›Œì§€ëŠ”ê°€?

### ğŸ“š Layerì™€ UnionFSì˜ ì´í•´

Docker ì´ë¯¸ì§€ëŠ” **ì—¬ëŸ¬ ê°œì˜ ì½ê¸° ì „ìš© ë ˆì´ì–´ê°€ ìŒ“ì¸ êµ¬ì¡°**ì…ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Container Layer (R/W)     â”‚  â† ì‹¤í–‰ ì‹œ ìƒì„±ë˜ëŠ” ì“°ê¸° ê°€ëŠ¥ ë ˆì´ì–´
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Layer 4: CMD            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Layer 3: COPY .         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Layer 2: RUN npm ci     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     Layer 1: FROM node      â”‚  â† ë² ì´ìŠ¤ ì´ë¯¸ì§€
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**UnionFS(Overlay2)**ëŠ” ì´ ë ˆì´ì–´ë“¤ì„ **í•˜ë‚˜ì˜ í†µí•©ëœ íŒŒì¼ì‹œìŠ¤í…œì²˜ëŸ¼** ë³´ì´ê²Œ í•©ë‹ˆë‹¤.

### 1ï¸âƒ£ ë ˆì´ì–´ì˜ ë¶ˆë³€ì„±: ê°€ì¥ í”í•œ ì‹¤ìˆ˜

> âš ï¸ **í•µì‹¬ í¬ì¸íŠ¸**: í•œ ë²ˆ ìƒì„±ëœ ë ˆì´ì–´ëŠ” ì ˆëŒ€ ìˆ˜ì •ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

```dockerfile
# âŒ ì˜ëª»ëœ ì˜ˆì‹œ: ìš©ëŸ‰ì´ ì „í˜€ ì¤„ì–´ë“¤ì§€ ì•ŠìŠµë‹ˆë‹¤
FROM ubuntu:22.04
RUN apt-get update && apt-get install -y build-essential  # Layer A: +500MB
RUN rm -rf /var/lib/apt/lists/*                           # Layer B: +0MB (ì‚­ì œ 'ê¸°ë¡'ë§Œ ì¶”ê°€)
```

**ê²°ê³¼**: ì´ ì´ë¯¸ì§€ í¬ê¸°ëŠ” ì—¬ì „íˆ 500MB ì´ìƒì…ë‹ˆë‹¤. ğŸ˜±

```dockerfile
# âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ: í•˜ë‚˜ì˜ ë ˆì´ì–´ì—ì„œ ì„¤ì¹˜ì™€ ì •ë¦¬ë¥¼ ë™ì‹œì—
FROM ubuntu:22.04
RUN apt-get update \
    && apt-get install -y build-essential \
    && rm -rf /var/lib/apt/lists/*  # ê°™ì€ ë ˆì´ì–´ì—ì„œ ì‚­ì œ â†’ ì‹¤ì œ ìš©ëŸ‰ ê°ì†Œ
```

### 2ï¸âƒ£ Copy-on-Write (CoW)

ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ë  ë•Œ, íŒŒì¼ ìˆ˜ì •ì€ ë‹¤ìŒê³¼ ê°™ì´ ì²˜ë¦¬ë©ë‹ˆë‹¤:

1. ì›ë³¸ ë ˆì´ì–´ì˜ íŒŒì¼ì€ **ê·¸ëŒ€ë¡œ ìœ ì§€**
2. ìˆ˜ì •ì´ í•„ìš”í•˜ë©´ í•´ë‹¹ íŒŒì¼ì„ **Container Layerë¡œ ë³µì‚¬**
3. ë³µì‚¬ëœ íŒŒì¼ì—ì„œë§Œ **ìˆ˜ì • ìˆ˜í–‰**

ì´ ë°©ì‹ ë•ë¶„ì— ê°™ì€ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ëŠ” ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆê°€ ë² ì´ìŠ¤ ë ˆì´ì–´ë¥¼ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 3ï¸âƒ£ ë¹Œë“œ ì‹œì ì—ë§Œ í•„ìš”í•œ íŒŒì¼ì´ ì´ë¯¸ì§€ì— í¬í•¨ë¨

ì»´íŒŒì¼ ë„êµ¬, í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¬¼, ìºì‹œ íŒŒì¼ ë“±ì€ ì‹¤í–‰ ì‹œì ì—ëŠ” í•„ìš” ì—†ì§€ë§Œ, ë¹Œë“œ ë‹¨ê³„ì—ì„œ ìƒì„±ëœ ì´ìƒ í•´ë‹¹ ë ˆì´ì–´ì— í¬í•¨ë©ë‹ˆë‹¤.

> ğŸ’¡ **ë©€í‹° ìŠ¤í…Œì´ì§€ ë¹Œë“œ**ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´, ì´ëŸ¬í•œ ë¶ˆí•„ìš”í•œ ë¹Œë“œ ì‚°ì¶œë¬¼ì´ ê·¸ëŒ€ë¡œ ìµœì¢… ì´ë¯¸ì§€ì— ë‚¨ì•„ ì´ë¯¸ì§€ê°€ ë¬´ê±°ì›Œì§‘ë‹ˆë‹¤.

---

## ğŸš€ ì´ë¯¸ì§€ ìµœì í™” ì „ëµ

### ğŸ› ï¸ ë¶„ì„ ë„êµ¬

| ë„êµ¬ | ìš©ë„ |
|------|------|
| ğŸ”¬ **dive** | Docker ì´ë¯¸ì§€ ë ˆì´ì–´ ë¶„ì„ |
| ğŸ“œ **docker history** | ë ˆì´ì–´ë³„ í¬ê¸° í™•ì¸ |
| ğŸ“¦ **jdeps** | Java ëª¨ë“ˆ ì˜ì¡´ì„± ë¶„ì„ |

---

### ğŸ“¦ Stage 1: Basic (Heavyweight JDK Image)

ê°œë°œ í™˜ê²½ êµ¬ì„±ì„ ê·¸ëŒ€ë¡œ ìœ ì§€í•œ ì´ˆê¸° ëª¨ë¸ì…ë‹ˆë‹¤.

```dockerfile
FROM eclipse-temurin:17-jdk
WORKDIR /app
COPY . .
RUN ./gradlew build -x test --no-daemon
ENTRYPOINT ["java", "-jar", "build/libs/bookshelf.jar"]
```

| í•­ëª© | ê²°ê³¼ |
|------|------|
| ğŸ“¦ ì´ë¯¸ì§€ í¬ê¸° | **743 MB** |
| ğŸ“š ë ˆì´ì–´ ìˆ˜ | 8ê°œ |
| â±ï¸ ë¹Œë“œ ì†ë„ | ğŸ”´ ë§¤ìš° ëŠë¦¼ |


âš ï¸ **ë¬¸ì œì **: JDK ì „ì²´ í¬í•¨, ë¹Œë“œ ì•„í‹°íŒ©íŠ¸ ì”ì¡´, Gradle ìºì‹œ ë° ì†ŒìŠ¤ì½”ë“œ í¬í•¨

---

### ğŸ”€ Stage 2: Multi-stage Build (Logical Separation)

ë¹Œë“œ í™˜ê²½ê³¼ ì‹¤í–‰ í™˜ê²½ì„ ë¬¼ë¦¬ì ìœ¼ë¡œ ê²©ë¦¬í•©ë‹ˆë‹¤.

```dockerfile
# ğŸ”¨ Stage 1: Build
FROM eclipse-temurin:17-jdk AS builder
WORKDIR /app
COPY gradlew .
COPY gradle gradle
COPY build.gradle settings.gradle ./
RUN ./gradlew dependencies --no-daemon || true
COPY src src
RUN ./gradlew bootJar --no-daemon -x test

# ğŸš€ Stage 2: Runtime
FROM eclipse-temurin:17-jdk
WORKDIR /app
COPY --from=builder /app/build/libs/bookshelf.jar app.jar
RUN groupadd -r appgroup && useradd -r -g appgroup appuser
ENTRYPOINT ["java", "-jar", "app.jar"]
```

| í•­ëª© | ê²°ê³¼ |
|------|------|
| ğŸ“¦ ì´ë¯¸ì§€ í¬ê¸° | **462 MB** |
| ğŸ“‰ ì ˆê° | 281 MB (**-39%**) |
| ğŸ“š ë ˆì´ì–´ ìˆ˜ | 8ê°œ |
| â±ï¸ ë¹Œë“œ ì†ë„ | ğŸŸ¡ ë³´í†µ |

**âœ… ê°œì„  ì‚¬í•­:**
- âœ… ì†ŒìŠ¤ì½”ë“œ ì œê±°
- âœ… Gradle ìºì‹œ ì œê±°
- âœ… ë¹Œë“œ ì•„í‹°íŒ©íŠ¸ ì œê±°
- âŒ JDK ì—¬ì „íˆ í¬í•¨ (JREë©´ ì¶©ë¶„)

---

### âš¡ Stage 3: JRE Only (Engine Replacement)

JDK(ê°œë°œìš©)ë¥¼ ì œê±°í•˜ê³  JRE(ì‹¤í–‰ ì „ìš©)ë¥¼ ë„ì…í•©ë‹ˆë‹¤.

```dockerfile
# ğŸ”¨ Stage 1: Build
FROM eclipse-temurin:17-jdk AS builder
# ... (ë¹Œë“œ ê³¼ì • ë™ì¼)

# ğŸš€ Stage 2: Runtime with JRE
FROM eclipse-temurin:17-jre
WORKDIR /app
COPY --from=builder /app/build/libs/bookshelf.jar app.jar
RUN groupadd -r appgroup && useradd -r -g appgroup appuser
ENV JAVA_OPTS="-XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0"
ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar app.jar"]
```

| í•­ëª© | ê²°ê³¼ |
|------|------|
| ğŸ“¦ ì´ë¯¸ì§€ í¬ê¸° | **312 MB** |
| ğŸ“‰ ì ˆê° | 431 MB (**-59%**) |
| ğŸ“š ë ˆì´ì–´ ìˆ˜ | 8ê°œ |
| â±ï¸ ë¹Œë“œ ì†ë„ | ğŸŸ¡ ë³´í†µ |

#### ğŸ†š JDK vs JRE ë¹„êµ

| êµ¬ì„±ìš”ì†Œ | JDK | JRE |
|---------|:---:|:---:|
| javac (ì»´íŒŒì¼ëŸ¬) | âœ… | âŒ |
| jshell | âœ… | âŒ |
| jlink | âœ… | âŒ |
| ê°œë°œ ë„êµ¬ | âœ… | âŒ |
| JVM ëŸ°íƒ€ì„ | âœ… | âœ… |
| í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ | âœ… | âœ… |

**ğŸ“Š ê°œì„  íš¨ê³¼**: JDK ë ˆì´ì–´ 279 MB â†’ JRE ë ˆì´ì–´ 140 MB (**139 MB ì ˆê°**)

---

### ğŸ”ï¸ Stage 4: Alpine Linux Base (OS Light-weighting)

ë²”ìš© OS(Ubuntu)ì—ì„œ ì´ˆê²½ëŸ‰ OS(Alpine)ë¡œ ê¸°ë°˜ ì „í™˜í•©ë‹ˆë‹¤.

```dockerfile
# ğŸ”¨ Stage 1: Build
FROM eclipse-temurin:17-jdk-alpine AS builder
# ... (ë¹Œë“œ ê³¼ì •)

# ğŸš€ Stage 2: Runtime with Alpine
FROM eclipse-temurin:17-jre-alpine
WORKDIR /app
COPY --from=builder /app/build/libs/bookshelf.jar app.jar
RUN addgroup -S appgroup && adduser -S appuser -G appgroup
ENV JAVA_OPTS="-XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0 -XX:+UseG1GC"
ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar app.jar"]
```

| í•­ëª© | ê²°ê³¼ |
|------|------|
| ğŸ“¦ ì´ë¯¸ì§€ í¬ê¸° | **234 MB** |
| ğŸ“‰ ì ˆê° | 509 MB (**-69%**) |
| ğŸ“š ë ˆì´ì–´ ìˆ˜ | 8ê°œ |
| â±ï¸ ë¹Œë“œ ì†ë„ | ğŸŸ¢ ë¹ ë¦„ |

#### ğŸ†š Debian vs Alpine ë¹„êµ

| í•­ëª© | Debian | Alpine |
|------|:------:|:------:|
| ê¸°ë³¸ ì´ë¯¸ì§€ í¬ê¸° | 78 MB | **8 MB** |
| C ë¼ì´ë¸ŒëŸ¬ë¦¬ | glibc | musl |
| íŒ¨í‚¤ì§€ ê´€ë¦¬ì | apt | apk |
| ì…¸ | bash | sh (busybox) |

---

### ğŸ”§ Stage 5: Custom JRE with Jlink (ì»¤ìŠ¤í…€ JRE) ğŸ†

JRE ì „ì²´ ëŒ€ì‹  í•„ìˆ˜ ëª¨ë“ˆë§Œ ì¡°ë¦½í•œ ì»¤ìŠ¤í…€ ì—”ì§„ì„ ì œì‘í•©ë‹ˆë‹¤.

```dockerfile
# ğŸ”¨ Stage 1: Build application
FROM eclipse-temurin:17-jdk-alpine AS builder
WORKDIR /app
COPY gradlew .
COPY gradle gradle
COPY build.gradle settings.gradle ./
RUN ./gradlew dependencies --no-daemon || true
COPY src src
RUN ./gradlew bootJar --no-daemon -x test

# âš™ï¸ Stage 2: Create custom JRE
FROM eclipse-temurin:17-jdk-alpine AS jre-builder
RUN $JAVA_HOME/bin/jlink \
    --add-modules java.base,java.logging,java.sql,java.naming,java.desktop,java.management,java.security.jgss,java.instrument \
    --strip-debug \
    --no-man-pages \
    --no-header-files \
    --compress=2 \
    --output /custom-jre

# ğŸš€ Stage 3: Minimal runtime
FROM alpine:3.19
RUN apk add --no-cache ca-certificates tzdata
COPY --from=jre-builder /custom-jre /opt/java
COPY --from=builder /app/build/libs/bookshelf.jar app.jar
ENV JAVA_HOME=/opt/java
ENV PATH="$JAVA_HOME/bin:$PATH"
ENV JAVA_OPTS="-XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0 -XX:+UseG1GC -XX:+UseStringDeduplication"
ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar app.jar"]
```

| í•­ëª© | ê²°ê³¼ |
|------|------|
| ğŸ“¦ ì´ë¯¸ì§€ í¬ê¸° | **122 MB** ğŸ† |
| ğŸ“‰ ì ˆê° | 621 MB (**-84%**) |
| ğŸ“š ë ˆì´ì–´ ìˆ˜ | 6ê°œ |
| â±ï¸ ë¹Œë“œ ì†ë„ | ğŸŸ¢ ë¹ ë¦„ |

**ğŸ“¦ jlink í¬í•¨ ëª¨ë“ˆ:**

| ëª¨ë“ˆ | ìš©ë„ |
|------|------|
| `java.base` | ğŸ”´ í•µì‹¬ í´ë˜ìŠ¤ (í•„ìˆ˜) |
| `java.logging` | ğŸ“ ë¡œê¹… API |
| `java.sql` | ğŸ—„ï¸ JDBC |
| `java.naming` | ğŸ“› JNDI |
| `java.desktop` | ğŸ–¼ï¸ AWT (ì¼ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì˜ì¡´ì„±) |
| `java.management` | ğŸ“Š JMX |
| `java.security.jgss` | ğŸ” ë³´ì•ˆ |
| `java.instrument` | ğŸ”¬ ì—ì´ì „íŠ¸ ì§€ì› |

**ğŸ“Š JRE í¬ê¸° ë¹„êµ:**

| JRE ìœ í˜• | í¬ê¸° | ì ˆê°ë¥  |
|---------|:----:|:------:|
| í‘œì¤€ JRE | 140 MB | - |
| Custom JRE (jlink) | **54.5 MB** | **-61%** |

---

### âš¡ Stage 6: GraalVM Native Image (ì„ íƒì )

AOT(Ahead-Of-Time) ì»´íŒŒì¼ì„ í†µí•´ JVM ì—†ì´ ë°”ì´ë„ˆë¦¬ë¡œ ì§ì ‘ ì‹¤í–‰í•©ë‹ˆë‹¤.

```dockerfile
# ğŸ”¨ Stage 1: Build Native Binary (AOT Compilation)
FROM ghcr.io/graalvm/native-image-community:17 AS builder
WORKDIR /app
COPY . .
RUN ./gradlew nativeCompile --no-daemon -x test

# ğŸš€ Stage 2: Ultra Minimal Runtime (No JVM)
FROM alpine:3.19
RUN apk add --no-cache ca-certificates tzdata gcompat
WORKDIR /app
COPY --from=builder /app/build/native/nativeCompile/bookshelf .
RUN addgroup -S appgroup && adduser -S appuser -G appgroup
USER appuser
ENTRYPOINT ["./bookshelf"]
```

| í•­ëª© | ê²°ê³¼ |
|------|------|
| ğŸ“¦ ì´ë¯¸ì§€ í¬ê¸° | **173 MB** (ìµœì í™” ì‹œ) |
| ğŸ“‰ ì ˆê° | **-77%** |
| ğŸ“š ë ˆì´ì–´ ìˆ˜ | 5ê°œ |
| â±ï¸ ë¹Œë“œ ì†ë„ | ğŸ”´ ë§¤ìš° ëŠë¦¼ |
| ğŸš€ ì‹¤í–‰ ì†ë„ | ğŸ’« **ì••ë„ì ** (0.1ì´ˆ ë‚´ì™¸) |

**âš ï¸ ìš©ëŸ‰ ë¶„ì„ (Jlinkì™€ì˜ ì—­ì „ í˜„ìƒ)**:

Native(173MB)ê°€ Jlink(122MB)ë³´ë‹¤ í¬ê²Œ ì¸¡ì •ëœ ì´ìœ ëŠ” **Spring Boot + JPA(Hibernate)** íŠ¹ì„±ì— ê¸°ì¸í•©ë‹ˆë‹¤. ëŸ°íƒ€ì„ì— í•„ìš”í•œ ë¦¬í”Œë ‰ì…˜ ì„¤ì •, í”„ë¡ì‹œ í´ë˜ìŠ¤, í”„ë ˆì„ì›Œí¬ ì§€ì› ì½”ë“œ ë“±ì´ ë°”ì´ë„ˆë¦¬ì— í¬í•¨ë©ë‹ˆë‹¤.

---

## ğŸ“Š í•µì‹¬ ê²°ê³¼ ìš”ì•½

| ìµœì í™” ë‹¨ê³„ | ì´ë¯¸ì§€ í¬ê¸° | ì ˆê°ë¥  | ì‹¤í–‰ì†ë„ |
|:-----------:|:-----------:|:------:|:--------:|
| ğŸ“¦ Basic | 743 MB | - | ë³´í†µ |
| ğŸ”€ Multistage | 462 MB | -39% | ë³´í†µ |
| âš¡ JRE | 312 MB | -59% | ë³´í†µ |
| ğŸ”ï¸ Alpine | 234 MB | -69% | ë¹ ë¦„ |
| ğŸ”§ **Jlink** | **122 MB** | **-84%** ğŸ† | ë¹ ë¦„ |
| âš¡ Native | 173 MB | -77% | **ğŸ’«ì••ë„ì ** |

### â­ ìµœì í™” íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Docker ì´ë¯¸ì§€ ìµœì í™” íë¦„              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ğŸ“¦ Basic (743MB)
      â”‚ ë©€í‹°ìŠ¤í…Œì´ì§€ ë¹Œë“œ
      â”‚ - ë¹Œë“œ/ëŸ°íƒ€ì„ ë¶„ë¦¬
      â–¼
  ğŸ”€ Multistage (462MB)  â”€â”€â”€â”€â”€â”€  -39%
      â”‚ JDK â†’ JRE ì „í™˜
      â–¼
  âš¡ JRE (312MB)  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  -59%
      â”‚ Debian â†’ Alpine
      â–¼
  ğŸ”ï¸ Alpine (234MB)  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  -69%
      â”‚ jlink ì»¤ìŠ¤í…€ JRE
      â–¼
  ğŸ”§ Jlink (122MB)  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  -84% ğŸ†


  [ë³„ë„: Native Image]
      â”‚ GraalVM AOT ì»´íŒŒì¼
      â–¼
  âš¡ Native (173MB)  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  -77%
     â””â†’ ì‹¤í–‰ì†ë„ 0.1ì´ˆ
```

---

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ğŸš¨ Issue #1: Native Imageì—ì„œ `chown` ì‚¬ìš© ì‹œ ì´ë¯¸ì§€ í¬ê¸° ê¸‰ì¦

#### ğŸ“‹ ìƒí™©

ë³´ì•ˆì„ ìœ„í•´ non-root ì‚¬ìš©ìë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ê³ ì `RUN chown`ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.

```dockerfile
# âŒ ë¬¸ì œê°€ ëœ Dockerfile
FROM alpine:3.19
RUN apk add --no-cache ca-certificates tzdata gcompat
WORKDIR /app

# ë°”ì´ë„ˆë¦¬ ë³µì‚¬
COPY --from=builder /app/build/native/nativeCompile/bookshelf .

# ë³´ì•ˆì„ ìœ„í•œ non-root ì‚¬ìš©ì ì„¤ì •
RUN addgroup -S appgroup && adduser -S appuser -G appgroup

# ğŸš¨ ë¬¸ì œ: chownìœ¼ë¡œ ì†Œìœ ê¶Œ ë³€ê²½
RUN chown -R appuser:appgroup /app

USER appuser
ENTRYPOINT ["./bookshelf"]
```

#### ğŸ’¥ ë¬¸ì œì 

| êµ¬ë¶„ | chown ë¯¸ì‚¬ìš© | chown ì‚¬ìš© |
|:----:|:-----------:|:----------:|
| ğŸ“¦ ì´ë¯¸ì§€ í¬ê¸° | 173 MB | **340+ MB** |
| ğŸ“š ë ˆì´ì–´ ìˆ˜ | 5 Layers | 6 Layers |

**ì´ë¯¸ì§€ í¬ê¸°ê°€ ê±°ì˜ 2ë°°ë¡œ ì¦ê°€!** 

#### ğŸ” ì›ì¸ ë¶„ì„

Dockerì˜ ë ˆì´ì–´ ì‹œìŠ¤í…œì—ì„œ `chown` ëª…ë ¹ì€ íŒŒì¼ì˜ ë©”íƒ€ë°ì´í„°ë§Œ ë³€ê²½í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, **í•´ë‹¹ íŒŒì¼ ì „ì²´ë¥¼ ìƒˆë¡œìš´ ë ˆì´ì–´ì— ë³µì‚¬**í•©ë‹ˆë‹¤.

```
Layer 1: [bookshelf ë°”ì´ë„ˆë¦¬ ~170MB] â† ì›ë³¸
Layer 2: [bookshelf ë°”ì´ë„ˆë¦¬ ~170MB] â† chownìœ¼ë¡œ ì¸í•œ ë³µì‚¬ë³¸
```

Native ë°”ì´ë„ˆë¦¬ëŠ” ì¼ë°˜ì ìœ¼ë¡œ **100MB ì´ìƒ**ì˜ í° íŒŒì¼ì´ê¸° ë•Œë¬¸ì—, `chown` í•œ ë²ˆìœ¼ë¡œ ì´ë¯¸ì§€ í¬ê¸°ê°€ **2ë°°**ë¡œ ì¦ê°€í•˜ëŠ” ì‹¬ê°í•œ ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤.

#### âœ… í•´ê²° ë°©ë²•

**ë°©ë²• 1: `COPY --chown` ì‚¬ìš© (ê¶Œì¥)**

```dockerfile
# âœ… í•´ê²°ëœ Dockerfile
FROM alpine:3.19
RUN apk add --no-cache ca-certificates tzdata gcompat

# ë¨¼ì € ì‚¬ìš©ì ìƒì„±
RUN addgroup -S appgroup && adduser -S appuser -G appgroup

WORKDIR /app

# ë³µì‚¬ì™€ ë™ì‹œì— ì†Œìœ ê¶Œ ì§€ì • (ì¶”ê°€ ë ˆì´ì–´ ì—†ìŒ!)
COPY --chown=appuser:appgroup --from=builder /app/build/native/nativeCompile/bookshelf .

USER appuser
ENTRYPOINT ["./bookshelf"]
```

**ë°©ë²• 2: USER ì „í™˜ í›„ ë³µì‚¬**

```dockerfile
# ğŸš€ Runtime stage  
FROM alpine:3.19
RUN apk add --no-cache ca-certificates tzdata gcompat \
    && addgroup -S appgroup && adduser -S appuser -G appgroup

USER appuser
WORKDIR /home/appuser

# appuserë¡œ ì „í™˜ í›„ ë³µì‚¬í•˜ë©´ ìë™ìœ¼ë¡œ í•´ë‹¹ ì‚¬ìš©ì ì†Œìœ 
COPY --from=builder /app/build/native/nativeCompile/bookshelf .

ENTRYPOINT ["./bookshelf"]
```

#### ğŸ“ í•µì‹¬ êµí›ˆ

| ğŸš« ì§€ì–‘ | âœ… ì§€í–¥ |
|:---------------|:------------|
| `RUN chown` ìœ¼ë¡œ ëŒ€ìš©ëŸ‰ íŒŒì¼ ì†Œìœ ê¶Œ ë³€ê²½ | `COPY --chown` ìœ¼ë¡œ ë³µì‚¬ ì‹œì ì— ì†Œìœ ê¶Œ ì§€ì • |
| íŒŒì¼ ë³µì‚¬ í›„ ë³„ë„ ë ˆì´ì–´ì—ì„œ ê¶Œí•œ ë³€ê²½ | ì‚¬ìš©ì ìƒì„± â†’ `USER` ì „í™˜ â†’ ë³µì‚¬ ìˆœì„œ |
| ë¶ˆí•„ìš”í•œ ë ˆì´ì–´ ìƒì„± | ëª…ë ¹ì–´ ë³‘í•©ìœ¼ë¡œ ë ˆì´ì–´ ìµœì†Œí™” |



---

### ğŸš¨ Issue #2: JVMì˜ ì»¨í…Œì´ë„ˆ ë©”ëª¨ë¦¬ ë¯¸ì¸ì§€ë¡œ ì¸í•œ ì„œë¹„ìŠ¤ ê°•ì œ ì¢…ë£Œ

#### ğŸ“‹ ìƒí™©

Stage 3(JRE ê¸°ë°˜)ë¡œ ë¹Œë“œí•œ ì´ë¯¸ì§€ë¥¼ ì»¨í…Œì´ë„ˆë¡œ ë°°í¬ í›„ ì„œë¹„ìŠ¤ ìš´ì˜ ì¤‘ **ê°‘ìê¸° í”„ë¡œì„¸ìŠ¤ê°€ ë‹¤ìš´**ë˜ëŠ” í˜„ìƒì´ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

| í•­ëª© | ìƒíƒœ |
|:----:|:-----|
| ğŸ”´ **ìƒíƒœ** | ì„œë¹„ìŠ¤ ìš´ì˜ ì¤‘ ê°‘ì‘ìŠ¤ëŸ¬ìš´ í”„ë¡œì„¸ìŠ¤ ë‹¤ìš´ |
| ğŸ“ **ë¡œê·¸** | ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ì— `OutOfMemoryError` ê¸°ë¡ **ì—†ìŒ** (Silent Death) |
| ğŸ³ **Docker** | `docker ps -a` í™•ì¸ ì‹œ ì¢…ë£Œ ì½”ë“œê°€ **`Exited (137)`** ë¡œ í‘œì‹œ |

> ğŸ’¡ **Exit Code 137**ì€ ì»¨í…Œì´ë„ˆê°€ `SIGKILL(128 + 9)` ì‹ í˜¸ë¥¼ ë°›ì•„ ê°•ì œ ì¢…ë£Œë˜ì—ˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

#### ğŸ” ì›ì¸ ë¶„ì„

JRE ê¸°ë°˜ ì»¨í…Œì´ë„ˆëŠ” JDK ê¸°ë°˜ë³´ë‹¤ ë¦¬ì†ŒìŠ¤ ì œí•œì— í›¨ì”¬ ë¯¼ê°í•˜ê²Œ ë°˜ì‘í•©ë‹ˆë‹¤. ë¬¸ì œì˜ í•µì‹¬ì€ **JVMì´ ì»¨í…Œì´ë„ˆ í™˜ê²½ì„ ì¸ì‹í•˜ì§€ ëª»í•˜ëŠ” ê²ƒ**ì…ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ë¬¸ì œ ë°œìƒ ë©”ì»¤ë‹ˆì¦˜                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  1ï¸âƒ£ ê°€ìƒí™”ì˜ ì°©ê°
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ JVM: "í˜¸ìŠ¤íŠ¸ 32GB â†’ ë‚´ ë©”ëª¨ë¦¬ 32GB!"                                       â”‚
  â”‚      (ì‹¤ì œ ì»¨í…Œì´ë„ˆ ì œí•œ: 1GB)                                              â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
  2ï¸âƒ£ ë©”ëª¨ë¦¬ ì´ˆê³¼ ì‚¬ìš©
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ JVMì´ ì»¨í…Œì´ë„ˆ ì œí•œ(1GB) ì´ˆê³¼ ì‹œë„                                           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
  3ï¸âƒ£ OOM Killer ê°œì…
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ ì»¤ë„: "í”„ë¡œì„¸ìŠ¤ ê°•ì œ ì¢…ë£Œ!"                                                  â”‚
  â”‚ â†’ SIGKILL(9) â†’ Exit Code 137                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
  4ï¸âƒ£ ì¶”ì  ë¶ˆê°€
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ OS ìˆ˜ì¤€ ì¢…ë£Œ â†’ Java ë¡œê·¸ ì—†ìŒ                                              â”‚
  â”‚ Silent Death ğŸ’€                                                            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜```
```
#### âœ… í•´ê²° ë°©ë²•

ìµœì¢… ìš´ì˜ ë‹¨ê³„(Stage 03)ì˜ Dockerfileì— **JVM ì˜µì…˜ì„ í™˜ê²½ ë³€ìˆ˜ë¡œ ì„¤ì •**í•˜ì—¬ ì»¨í…Œì´ë„ˆ í™˜ê²½ì— ìµœì í™”í•©ë‹ˆë‹¤.

```dockerfile
# âœ… í•´ê²°ëœ Dockerfile
FROM eclipse-temurin:17-jre
WORKDIR /app
COPY --from=builder /app/build/libs/bookshelf.jar app.jar

# ğŸ”§ ì»¨í…Œì´ë„ˆ ì¸ì‹ì„ ìœ„í•œ JVM ì˜µì…˜ ì„¤ì •
ENV JAVA_OPTS="-XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0"

ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar app.jar"]
```

#### ğŸ“– ì ìš© ì˜µì…˜ ìƒì„¸

| ì˜µì…˜ | ì„¤ëª… |
|:-----|:-----|
| `-XX:+UseContainerSupport` | JVMì´ **cgroups**(Docker ë¦¬ì†ŒìŠ¤ ì œí•œ ë„êµ¬)ë¥¼ í™•ì¸í•˜ë„ë¡ ì„¤ì •. í˜¸ìŠ¤íŠ¸ê°€ ì•„ë‹Œ **ì»¨í…Œì´ë„ˆì— í• ë‹¹ëœ ë©”ëª¨ë¦¬**ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë™ì‘ |
| `-XX:MaxRAMPercentage=75.0` | í™(Heap) ë©”ëª¨ë¦¬ë¥¼ ì»¨í…Œì´ë„ˆ ê°€ìš© ìì›ì˜ **75%**ë¡œ ì œí•œ |

#### ğŸ’¡ ì™œ 75%ì¸ê°€?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ì»¨í…Œì´ë„ˆ ë©”ëª¨ë¦¬ êµ¬ì„± (1GB ê¸°ì¤€)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                             â”‚
  â”‚    Heap Memory (75%)        â”‚
  â”‚         768 MB              â”‚  â† MaxRAMPercentage
  â”‚                             â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Metaspace  â”‚  Stack         â”‚
  â”‚ (í´ë˜ìŠ¤)   â”‚  (ìŠ¤ë ˆë“œ)       â”‚  â† Non-Heap
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ Native     â”‚  OS Overhead   â”‚
  â”‚ (JNI, ë²„í¼)â”‚  (ì»¤ë„, ìºì‹œ)   â”‚  â† ì‹œìŠ¤í…œ
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â””â”€â”€ 25% (256MB) â”€â”€â”˜
```

JavaëŠ” í™ ë©”ëª¨ë¦¬ ì™¸ì—ë„ **Metaspace, Stack, Native Memory** ë“±ì˜ Non-Heap ì˜ì—­ì´ í•„ìš”í•©ë‹ˆë‹¤. 100%ë¥¼ í™ì— í• ë‹¹í•˜ë©´ ì´ëŸ¬í•œ ì˜ì—­ì´ ë¶€ì¡±í•´ì ¸ ê²°êµ­ ë‹¤ì‹œ OOM Killerì˜ ëŒ€ìƒì´ ë©ë‹ˆë‹¤. **25%ì˜ ì™„ì¶© ì§€ëŒ€**ë¥¼ í™•ë³´í•˜ì—¬ ì•ˆì •ì ì¸ ìš´ì˜ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

#### âœ… ê²°ê³¼

| í•­ëª© | ê°œì„  ì „ | ê°œì„  í›„ |
|:----:|:-------:|:-------:|
| ë©”ëª¨ë¦¬ ì¸ì‹ | í˜¸ìŠ¤íŠ¸ ì „ì²´ ë©”ëª¨ë¦¬ | ì»¨í…Œì´ë„ˆ í• ë‹¹ ë©”ëª¨ë¦¬ |
| ì„œë¹„ìŠ¤ ì•ˆì •ì„± | ëœë¤ ë‹¤ìš´ (Exit 137) | âœ… ì•ˆì •ì  ìš´ì˜ |
| ë©”ëª¨ë¦¬ ì‚¬ìš© | ë¬´ì œí•œ (OOM ìœ„í—˜) | 75% ì´ë‚´ ê´€ë¦¬ |

---

## ğŸ“Š CI/CD íŒŒì´í”„ë¼ì¸ ê°œì„  íš¨ê³¼

### ğŸ—ï¸ CI ë‹¨ê³„: ë¹Œë“œ ì‹œê°„ ê°ì†Œ

| ì§€í‘œ | ìµœì í™” ì „ | ìµœì í™” í›„ | ê°œì„ ìœ¨ |
|:----:|:---------:|:---------:|:------:|
| ì´ˆê¸° ë¹Œë“œ | 67ì´ˆ | 86ì´ˆ | 23% â†‘ |
| ì½”ë“œ ë³€ê²½ í›„ ì¬í–¥ë¹Œë“œ | 68ì´ˆ | 49ì´ˆ | **28% â†“** |
| ì´ë¯¸ì§€ í¬ê¸° | 743MB | 122MB | 84% â†“ |

**ğŸ‘¨â€ğŸ’» ê°œë°œì ìƒì‚°ì„± í–¥ìƒ**: í•˜ë£¨ 50ë²ˆ ë¹Œë“œ Ã— 20ì´ˆ ì ˆì•½ = **ì¼ 15ë¶„ ì ˆì•½**

### ğŸš€ CD ë‹¨ê³„: ë°°í¬ ì†ë„ í–¥ìƒ

```
ğŸ“Š ì´ë¯¸ì§€ Push/Pull ì†ë„ ë¹„êµ (100Mbps ë„¤íŠ¸ì›Œí¬ ê¸°ì¤€)

743MB ì´ë¯¸ì§€:
  Push: ~68ì´ˆ | Pull: ~68ì´ˆ | ì´ ë°°í¬: ~2ë¶„ 20ì´ˆ

122MB ì´ë¯¸ì§€:
  Push: ~10ì´ˆ | Pull: ~10ì´ˆ | ì´ ë°°í¬: ~20ì´ˆ
```

**ğŸ”„ ì¥ì•  ë³µêµ¬(Rollback) ì‹œê°„**: 2ë¶„ 20ì´ˆ â†’ 20ì´ˆ (ê¸´ê¸‰ ìƒí™©ì—ì„œ ê²°ì •ì  ì°¨ì´)

### ğŸ’° ìš´ì˜ ê´€ì : ë¹„ìš© ì ˆê°

#### 1. ì˜¤í† ìŠ¤ì¼€ì¼ë§ Cold Start ê°œì„ 

```
ğŸš€ íŠ¸ë˜í”½ ê¸‰ì¦ ì‹œ ìƒˆ ì¸ìŠ¤í„´ìŠ¤ ê¸°ë™ ì‹œê°„:

í° ì´ë¯¸ì§€ (743MB):
  ì´ë¯¸ì§€ Pull: 68ì´ˆ + ì»¨í…Œì´ë„ˆ ì‹œì‘: 5ì´ˆ = ì´ 73ì´ˆ
  â†’ íŠ¸ë˜í”½ ê¸‰ì¦ ì‹œ 73ì´ˆê°„ ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ì— ê³¼ë¶€í•˜ âŒ

ì‘ì€ ì´ë¯¸ì§€ (122MB):
  ì´ë¯¸ì§€ Pull: 10ì´ˆ + ì»¨í…Œì´ë„ˆ ì‹œì‘: 5ì´ˆ = ì´ 15ì´ˆ
  â†’ ë¹ ë¥¸ ìŠ¤ì¼€ì¼ì•„ì›ƒìœ¼ë¡œ ì•ˆì •ì  ì„œë¹„ìŠ¤ âœ…
```

#### 2. í´ë¼ìš°ë“œ ë¹„ìš© ì ˆê°

```
ğŸ’µ ì›”ê°„ Egress ë¹„ìš© ê³„ì‚° (AWS ê¸°ì¤€, $0.09/GB)

ì‹œë‚˜ë¦¬ì˜¤: ì¼ 100íšŒ ë°°í¬ Ã— 30ì¼ = ì›” 3,000íšŒ ë°°í¬

í° ì´ë¯¸ì§€: 3,000 Ã— 743MB = 2,176GB â†’ $195.84/ì›”
ì‘ì€ ì´ë¯¸ì§€: 3,000 Ã— 122MB = 357GB  â†’ $32.13/ì›”

ì›” ì ˆê°ì•¡: $163.71 (ì—°ê°„ $1964.52) ğŸ’°
```

#### 3. ë ˆì§€ìŠ¤íŠ¸ë¦¬ ìŠ¤í† ë¦¬ì§€ ë¹„ìš©

```
ğŸ“¦ ì´ë¯¸ì§€ ë²„ì „ 100ê°œ ë³´ê´€ ì‹œ:

í° ì´ë¯¸ì§€: 7432MB Ã— 100 = 72.56GB ìŠ¤í† ë¦¬ì§€
ì‘ì€ ì´ë¯¸ì§€: 122MB Ã— 100 = 11.91GB ìŠ¤í† ë¦¬ì§€

60.65GB ìŠ¤í† ë¦¬ì§€ ì ˆê° âœ…
```

---

## ğŸ’¡ ê¶Œì¥ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

| ì‹œë‚˜ë¦¬ì˜¤ | ê¶Œì¥ ì „ëµ | ì´ìœ  |
|:--------:|:---------:|:-----|
| ì¼ë°˜ì ì¸ ì„œë¹„ìŠ¤ | ğŸ”§ **Jlink** | ìš©ëŸ‰ ìµœì†Œ (122MB), ë¹ ë¥¸ ë°°í¬ |
| ì„œë²„ë¦¬ìŠ¤/FaaS | âš¡ **Native Image** | 0.1ì´ˆ Cold Start |
| ë¹ ë¥¸ ê°œë°œ ì‚¬ì´í´ | ğŸ”ï¸ **Alpine + JRE** | ë¹Œë“œ/ë°°í¬ ê· í˜• |
| ë ˆê±°ì‹œ í˜¸í™˜ì„± í•„ìš” | ğŸ”€ **Multi-stage** | glibc í˜¸í™˜ ìœ ì§€ |

---

## âœ… ìµœì í™” ì²´í¬ë¦¬ìŠ¤íŠ¸

| # | í•­ëª© | ì²´í¬ |
|:-:|:-----|:----:|
| 1 | ğŸ”ï¸ ë² ì´ìŠ¤ ì´ë¯¸ì§€ë¥¼ Alpine ë˜ëŠ” Distrolessë¡œ êµì²´í–ˆëŠ”ê°€? | â¬œ |
| 2 | ğŸ”€ Multi-Stage Buildë¥¼ ì ìš©í–ˆëŠ”ê°€? | â¬œ |
| 3 | ğŸ”§ Jlink ë˜ëŠ” Native Imageë¥¼ í™œìš©í•´ ëŸ°íƒ€ì„ì„ ê²½ëŸ‰í™”í–ˆëŠ”ê°€? | â¬œ |
| 4 | ğŸ“‹ Dockerfile ëª…ë ¹ì–´ë¥¼ ë³€ê²½ ë¹ˆë„ ìˆœìœ¼ë¡œ ì •ë ¬í–ˆëŠ”ê°€? | â¬œ |
| 5 | ğŸš« `.dockerignore`ë¡œ ë¶ˆí•„ìš”í•œ íŒŒì¼ì„ ì œì™¸í–ˆëŠ”ê°€? | â¬œ |
| 6 | ğŸ“¦ í”„ë¡œë•ì…˜ ì˜ì¡´ì„±ë§Œ ì„¤ì¹˜í–ˆëŠ”ê°€? | â¬œ |

---

## ğŸ’¡ ê²°ë¡  ë° ì‹œì‚¬ì 

1. **ğŸ–¥ï¸ ì¸í”„ë¼ íš¨ìœ¨ì„±**: ìš©ëŸ‰ ìµœì í™”ë¥¼ í†µí•´ ë™ì¼ ì„œë²„ ìì›ì—ì„œ ì•½ **6ë°°** ë” ë§ì€ ì»¨í…Œì´ë„ˆ ìš´ìš©ì´ ê°€ëŠ¥í•´ì¡ŒìŠµë‹ˆë‹¤.

2. **ğŸš€ ë°°í¬ ì†ë„**: ì´ë¯¸ì§€ í¬ê¸° ê°ì†Œë¡œ ì¸í•œ ë„¤íŠ¸ì›Œí¬ ë¹„ìš© ê°ì†Œë¡œ ì¸í•´ CI/CD íš¨ìœ¨ì´ ê·¹ëŒ€í™”ë˜ì—ˆìŠµë‹ˆë‹¤.


> **ğŸ“Œ í•µì‹¬ ë©”ì‹œì§€**: Docker ì´ë¯¸ì§€ ìµœì í™”ëŠ” ë‹¨ìˆœí•œ ê¸°ìˆ ì  ê°œì„ ì´ ì•„ë‹™ë‹ˆë‹¤. ê°œë°œì ìƒì‚°ì„±, ì„œë¹„ìŠ¤ ì•ˆì •ì„±, ê·¸ë¦¬ê³  ìš´ì˜ ë¹„ìš©ì— ì§ì ‘ì ì¸ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” **ë¹„ì¦ˆë‹ˆìŠ¤ ê°€ì¹˜**ì…ë‹ˆë‹¤.

---

## ğŸ“š ì°¸ê³  ìë£Œ

- ğŸ“– [Docker Official Documentation - Best practices for writing Dockerfiles](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)
- ğŸ“– [Google Distroless Images](https://github.com/GoogleContainerTools/distroless)
- ğŸ“– [Alpine Linux](https://alpinelinux.org/)
- ğŸ“– [GraalVM Native Image](https://www.graalvm.org/native-image/)
- ğŸ“– [Eclipse Temurin](https://adoptium.net/temurin/)

---

## ğŸ‘¥ ê¸°ì—¬ì

| ì´ë¦„ | ì—­í•  |
|:----:|:----:|
| ê¹€ì¢…ì—° | ğŸ“ |
| ì„œì§€í˜œ | ğŸ“ |
| ì´ë™ìš± | ğŸ“ |

---

## ğŸ“„ ë¼ì´ì„ ìŠ¤

MIT License

---

<div align="center">

**â­ ì´ í”„ë¡œì íŠ¸ê°€ ë„ì›€ì´ ë˜ì—ˆë‹¤ë©´ Starë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”! â­**

</div>